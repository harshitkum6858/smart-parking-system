{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Details for {{ lot.name }}</h2>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Back</a>
</div>

<div class="mb-3">
    <input type="text" id="spotSearch" class="form-control" placeholder="Search for Spot #...">
</div>

<div class="row" id="spotsContainer">
    {% for spot in lot.spots.all() %}
    <div class="col-md-2 mb-3 spot-card" data-spot-number="{{ spot.spot_number }}">
        <div class="card text-center {% if spot.status == 'O' %}border-danger{% else %}border-success{% endif %}">
            <div class="card-header fw-bold">
                Spot #{{ spot.spot_number }}
            </div>
            <div class="card-body">
                {% if spot.status == 'O' %}
                    <h5 class="card-title text-danger"><i class="bi bi-x-circle-fill"></i> Occupied</h5>
                    <p class="card-text mb-0">
                        <small>By: {{ spot.reservation.user.username }}</small>
                    </p>
                {% else %}
                    <h5 class="card-title text-success"><i class="bi bi-check-circle-fill"></i> Available</h5>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('spotSearch').addEventListener('keyup', function() {
    let filter = this.value.toLowerCase();
    let cards = document.querySelectorAll('.spot-card');
    cards.forEach(card => {
        let spotNumber = card.getAttribute('data-spot-number');
        if (spotNumber.includes(filter)) {
            card.style.display = '';
        } else {
            card.style.display = 'none';
        }
    });
});
</script>
{% endblock %}